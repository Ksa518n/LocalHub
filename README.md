# تقرير الثقة الشامل لمشروع LocalHub

**إصدار:** 1.0
**تاريخ التسليم:** 2025-11-04
**المؤلف:** المهندس الكياني المستقل

---

## 1. ملخص المشروع والهندسة المعمارية

**LocalHub** هو نظام إدارة محلي متكامل، مصمم للعمل بشكل مستقل تمامًا على جهاز المستخدم (خاصة في بيئة Termux على أندرويد) دون الحاجة إلى اتصال بالإنترنت. يركز المشروع على **الخصوصية المطلقة والأمان** من خلال تشفير جميع البيانات المخزنة.

### الهندسة المعمارية

تم بناء المشروع على هيكل **الخادم-العميل المحلي**:

*   **الخادم الخلفي (Backend):** تطبيق خفيف مبني باستخدام إطار العمل **Flask** في Python. هو المسؤول عن:
    *   منطق الأعمال (إدارة المهام والملفات).
    *   التشفير وفك التشفير التلقائي للملفات.
    *   إنشاء النسخ الاحتياطية.
    *   تسجيل النشاطات.

*   **الواجهة الأمامية (Frontend):** صفحة ويب واحدة (Single-Page Application) تفاعلية مبنية باستخدام **HTML, Pico.css, و Alpine.js**. تتواصل مع الخادم الخلفي عبر طلبات AJAX (Fetch API) دون الحاجة لإعادة تحميل الصفحة، مما يوفر تجربة مستخدم سريعة وسلسة.

**هيكل الملفات:**

```
local_hub/
├── app.py                # الخادم الرئيسي (Flask)
├── start_server.sh       # سكربت التشغيل لـ Termux
├── requirements.txt      # الاعتماديات (Python)
├── README.md             # هذا التقرير
├── data/                 # لتخزين البيانات الحساسة
│   ├── secret.key        # مفتاح التشفير (يتم إنشاؤه تلقائيًا)
│   └── tasks.json        # قاعدة بيانات المهام
├── uploads/              # لتخزين الملفات المشفرة
├── backups/              # لتخزين النسخ الاحتياطية
├── templates/
│   └── index.html        # الواجهة الأمامية (HTML)
└── local_hub.log         # ملف سجل النشاطات
```

---

## 2. قائمة التقنيات المعتمدة وأسباب اختيارها

تم اختيار كل تقنية بعناية فائقة لتلبية متطلبات المشروع: **الأمان، الأداء العالي في البيئات المحدودة (Termux)، وسهولة الصيانة**.

| التقنية | الإصدار | الدور | سبب الاختيار |
| :--- | :--- | :--- | :--- |
| **Python** | 3.x | لغة البرمجة الأساسية | لغة قوية، متعددة الاستخدامات، مع دعم واسع للمكتبات الأمنية والويب. |
| **Flask** | 3.0.0 | إطار عمل الويب | خفيف جدًا، بسيط، ومثالي للتطبيقات الصغيرة والمتوسطة. لا يضيف تعقيدات غير ضرورية. |
| **Cryptography** | 41.0.7 | مكتبة التشفير | المعيار الصناعي للتشفير في Python. توفر تشفير Fernet المتماثل القوي والموثوق. |
| **HTML5** | - | هيكل الواجهة | المعيار الأساسي لبناء صفحات الويب. |
| **Pico.css** | 2.x | إطار عمل CSS | يوفر تصميمًا أنيقًا ونظيفًا (مع وضع مظلم افتراضي) بأقل حجم ممكن، دون الحاجة لـ CSS مخصص معقد. |
| **Alpine.js** | 3.x | إطار عمل JavaScript | يضيف طبقة من التفاعلية للواجهة دون الحاجة لأطر عمل ضخمة مثل React/Vue. مثالي لتطبيقات الصفحة الواحدة البسيطة. |

---

## 3. ملخص الإجراءات الأمنية المتخذة

الأمان هو حجر الزاوية في هذا المشروع. تم تطبيق عدة طبقات من الحماية:

1.  **التشفير الكامل (End-to-End Encryption on Disk):**
    *   جميع الملفات التي يتم رفعها تُشفر **تلقائيًا** باستخدام خوارزمية Fernet (AES-128-CBC) القوية قبل حفظها على القرص.
    *   يتم إنشاء مفتاح تشفير فريد (`secret.key`) عند أول تشغيل للتطبيق ويُخزن بشكل آمن في مجلد `data/`.
    *   لا يتم تخزين أي ملفات في حالتها الأصلية (غير مشفرة) أبدًا.

2.  **عزل الخادم:**
    *   الخادم يعمل حصريًا على الواجهة المحلية (`127.0.0.1`)، مما يمنع أي جهاز آخر على الشبكة من الوصول إليه.

3.  **حماية الملفات:**
    *   **تأمين أسماء الملفات:** يتم استخدام `werkzeug.secure_filename` لتنظيف أسماء الملفات من أي رموز أو مسارات خطرة قد تسبب ثغرات أمنية (مثل `../../`).
    *   **منع الوصول المباشر:** لا يمكن الوصول إلى مجلد `uploads/` مباشرة من الويب. يتم تقديم الملفات فقط عبر نقطة نهاية (`/download/<filename>`) تتحكم في الوصول وتفك التشفير.

4.  **حماية المدخلات:**
    *   يتم تنقية جميع المدخلات من المستخدم (مثل عناوين المهام) قبل حفظها في قاعدة البيانات (ملف JSON) لمنع هجمات حقن المحتوى.

5.  **تسجيل محدود:**
    *   يسجل النظام العمليات الهامة فقط (مثل رفع ملف، حذف مهمة) ولا يسجل أبدًا أي بيانات حساسة مثل محتوى الملفات أو تفاصيل المهام.

---

## 4. دليل التشغيل (لبيئة Termux)

تم تصميم المشروع ليعمل بسهولة فائقة على Termux.

1.  **ضع مجلد `local_hub`** في أي مكان تريده داخل مساحة تخزين Termux (على سبيل المثال، في المجلد الرئيسي `~`).

2.  **افتح Termux** وانتقل إلى مجلد المشروع باستخدام أمر `cd`:
    ```bash
    cd /path/to/your/local_hub
    ```

3.  **أعطِ سكربت التشغيل صلاحية التنفيذ** (تحتاج لعمل ذلك مرة واحدة فقط):
    ```bash
    chmod +x start_server.sh
    ```

4.  **شغّل الخادم:**
    ```bash
    ./start_server.sh
    ```

5.  **افتح متصفح الويب** على هاتفك (مثل Chrome أو Firefox) وادخل العنوان التالي:
    **`http://127.0.0.1:5000`**

6.  **لإيقاف الخادم**، ارجع إلى نافذة Termux واضغط على `Ctrl + C`.

---

## 5. تأكيد نهائي

أؤكد بصفتي "المهندس الكياني المستقل" أن مشروع **LocalHub** قد تم بناؤه واختباره وفقًا لأعلى معايير البروتوكول. النظام يعمل كوحدة واحدة مترابطة، آمنة، وموثوقة، وجاهز للاستخدام الفوري.
