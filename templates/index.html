<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalHub - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ</title>
    
    <!-- Pico.css Ù„Ù„ØªØµÙ…ÙŠÙ… -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    
    <!-- Alpine.js Ù„Ù„ØªÙØ§Ø¹Ù„ÙŠØ© -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js"></script>
    
    <style>
        :root {
            --primary: #8b5cf6;
            --primary-hover: #7c3aed;
            --primary-focus: rgba(139, 92, 246, 0.125);
        }
        
        body {
            padding-bottom: 80px;
            background-color: #1a1a1a;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        header {
            text-align: center;
            padding: 2rem 0;
            border-bottom: 2px solid var(--primary);
            margin-bottom: 2rem;
        }
        
        header h1 {
            color: var(--primary);
            margin: 0;
            font-size: 2.5rem;
        }
        
        header p {
            color: #888;
            margin: 0.5rem 0 0 0;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #2a2a2a;
            border-top: 2px solid var(--primary);
            padding: 0.5rem;
            display: flex;
            justify-content: space-around;
            gap: 0.5rem;
            z-index: 1000;
        }
        
        .bottom-nav button {
            flex: 1;
            margin: 0;
            background: var(--primary);
            border: none;
            padding: 0.75rem 0.5rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bottom-nav button:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        .bottom-nav button.active {
            background: var(--primary-hover);
            box-shadow: 0 0 10px var(--primary);
        }
        
        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù… */
        .task-card {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.2s;
        }
        
        .task-card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 10px var(--primary-focus);
        }
        
        .task-card.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .task-title {
            font-weight: bold;
            color: var(--primary);
            margin: 0;
        }
        
        .task-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .task-actions button {
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
            margin: 0;
        }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª */
        .file-item {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }
        
        .file-item:hover {
            border-color: var(--primary);
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }
        
        .file-meta {
            font-size: 0.85rem;
            color: #888;
        }
        
        .file-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .file-actions button {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            margin: 0;
        }
        
        /* Ø§Ù„Ø³Ø¬Ù„Ø§Øª */
        .log-container {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 1rem;
            max-height: 500px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85rem;
            direction: ltr;
            text-align: left;
        }
        
        .log-line {
            margin-bottom: 0.25rem;
            color: #aaa;
        }
        
        .log-line.info {
            color: #4ade80;
        }
        
        .log-line.error {
            color: #f87171;
        }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-message {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            animation: slideIn 0.3s ease-out;
        }
        
        .status-message.success {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid #4ade80;
            color: #4ade80;
        }
        
        .status-message.error {
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid #f87171;
            color: #f87171;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
        input[type="file"] {
            cursor: pointer;
        }
        
        button[type="submit"] {
            background: var(--primary);
        }
        
        button[type="submit"]:hover {
            background: var(--primary-hover);
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #666;
        }
        
        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 1rem;
            opacity: 0.3;
        }
    </style>
</head>
<body x-data="app()" x-init="init()">
    
    <!-- Ø§Ù„Ø±Ø£Ø³ -->
    <header>
        <h1>ğŸ”’ LocalHub</h1>
        <p>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ Ø§Ù„Ø¢Ù…Ù† ÙˆØ§Ù„Ù…Ø´ÙØ±</p>
    </header>
    
    <div class="container">
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù„ÙØ§Øª -->
        <section id="files-section" class="section" :class="{ 'active': currentSection === 'files' }">
            <h2>ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©</h2>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div x-show="fileStatus.message" 
                 x-transition
                 class="status-message" 
                 :class="fileStatus.type">
                <span x-text="fileStatus.message"></span>
            </div>
            
            <!-- Ù†Ù…ÙˆØ°Ø¬ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª -->
            <article>
                <h3>Ø±ÙØ¹ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯</h3>
                <form @submit.prevent="uploadFile">
                    <input type="file" 
                           x-ref="fileInput" 
                           required 
                           accept="*/*">
                    <button type="submit" :disabled="uploading">
                        <span x-show="!uploading">ğŸ“¤ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</span>
                        <span x-show="uploading">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...</span>
                    </button>
                </form>
            </article>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª -->
            <article>
                <h3>Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h3>
                <template x-if="files.length === 0">
                    <div class="empty-state">
                        <p>ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø©</p>
                    </div>
                </template>
                
                <template x-for="file in files" :key="file.internal_name">
                    <div class="file-item">
                        <div class="file-info">
                            <div class="file-name" x-text="file.name"></div>
                            <div class="file-meta">
                                <span x-text="formatFileSize(file.size)"></span> â€¢ 
                                <span x-text="formatDate(file.uploaded_at)"></span>
                            </div>
                        </div>
                        <div class="file-actions">
                            <button @click="downloadFile(file.name)">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„</button>
                            <button @click="deleteFile(file.name)" class="secondary">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                        </div>
                    </div>
                </template>
            </article>
        </section>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù‡Ø§Ù… -->
        <section id="tasks-section" class="section" :class="{ 'active': currentSection === 'tasks' }">
            <h2>âœ… Ù…Ù‡Ø§Ù…ÙŠ</h2>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div x-show="taskStatus.message" 
                 x-transition
                 class="status-message" 
                 :class="taskStatus.type">
                <span x-text="taskStatus.message"></span>
            </div>
            
            <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© -->
            <article>
                <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <form @submit.prevent="addTask">
                    <input type="text" 
                           x-model="newTask.title" 
                           placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©" 
                           required>
                    <textarea x-model="newTask.description" 
                              placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" 
                              rows="3"></textarea>
                    <input type="date" 
                           x-model="newTask.due_date" 
                           placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                    <button type="submit">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©</button>
                </form>
            </article>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… -->
            <article>
                <h3>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
                <template x-if="tasks.length === 0">
                    <div class="empty-state">
                        <p>âœ¨ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠÙ‹Ø§</p>
                    </div>
                </template>
                
                <template x-for="task in tasks" :key="task.id">
                    <div class="task-card" :class="{ 'completed': task.completed }">
                        <div class="task-header">
                            <h4 class="task-title" x-text="task.title"></h4>
                            <div class="task-actions">
                                <button @click="toggleTask(task)" 
                                        :class="task.completed ? 'secondary' : ''">
                                    <span x-show="!task.completed">âœ“</span>
                                    <span x-show="task.completed">â†º</span>
                                </button>
                                <button @click="deleteTask(task.id)" class="secondary">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <p x-show="task.description" x-text="task.description" style="margin: 0.5rem 0; color: #aaa;"></p>
                        <small x-show="task.due_date" style="color: #888;">
                            ğŸ“… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <span x-text="formatDate(task.due_date)"></span>
                        </small>
                    </div>
                </template>
            </article>
        </section>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª -->
        <section id="logs-section" class="section" :class="{ 'active': currentSection === 'logs' }">
            <h2>ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h2>
            
            <article>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3>Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h3>
                    <button @click="loadLogs" class="secondary">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
                </div>
                
                <div class="log-container">
                    <template x-if="logs.length === 0">
                        <div class="empty-state">
                            <p>ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª</p>
                        </div>
                    </template>
                    
                    <template x-for="log in logs" :key="log">
                        <div class="log-line" 
                             :class="{ 'info': log.includes('INFO'), 'error': log.includes('ERROR') }"
                             x-text="log"></div>
                    </template>
                </div>
            </article>
        </section>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
        <section id="settings-section" class="section" :class="{ 'active': currentSection === 'settings' }">
            <h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div x-show="settingsStatus.message" 
                 x-transition
                 class="status-message" 
                 :class="settingsStatus.type">
                <span x-text="settingsStatus.message"></span>
            </div>
            
            <!-- Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
            <article>
                <h3>ğŸ’¾ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h3>
                <p>Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ø¶ØºÙˆØ·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§ØªÙƒ ÙˆÙ…Ù‡Ø§Ù…Ùƒ.</p>
                <button @click="createBackup" :disabled="backingUp">
                    <span x-show="!backingUp">ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</span>
                    <span x-show="backingUp">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...</span>
                </button>
            </article>
            
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
            <article>
                <h3>â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                <table>
                    <tbody>
                        <tr>
                            <td><strong>Ø§Ø³Ù… Ø§Ù„Ù†Ø¸Ø§Ù…</strong></td>
                            <td>LocalHub v1.0</td>
                        </tr>
                        <tr>
                            <td><strong>Ø§Ù„ØªØ´ÙÙŠØ±</strong></td>
                            <td>âœ… Ù…ÙØ¹Ù‘Ù„ (Fernet)</td>
                        </tr>
                        <tr>
                            <td><strong>Ø§Ù„ÙˆØ¶Ø¹</strong></td>
                            <td>ğŸ”’ Ù…Ø­Ù„ÙŠ ÙÙ‚Ø· (127.0.0.1)</td>
                        </tr>
                        <tr>
                            <td><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª</strong></td>
                            <td><span x-text="files.length"></span></td>
                        </tr>
                        <tr>
                            <td><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…</strong></td>
                            <td><span x-text="tasks.length"></span></td>
                        </tr>
                    </tbody>
                </table>
            </article>
            
            <!-- Ø­ÙˆÙ„ -->
            <article>
                <h3>ğŸ“– Ø­ÙˆÙ„ LocalHub</h3>
                <p>
                    LocalHub Ù‡Ùˆ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­Ù„ÙŠ Ø¢Ù…Ù† ÙˆÙ…Ø´ÙØ±ØŒ Ù…ØµÙ…Ù… Ù„Ù„Ø¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ø¥Ù†ØªØ±Ù†Øª.
                    Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§ØªÙƒ Ù…Ø­Ù…ÙŠØ© Ø¨ØªØ´ÙÙŠØ± Ù‚ÙˆÙŠØŒ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§ Ø¥Ù„Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.
                </p>
                <p style="color: #888; font-size: 0.9rem;">
                    ØªÙ… Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø©: Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„ÙƒÙŠØ§Ù†ÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ù„<br>
                    Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª: Flask + Alpine.js + Pico.css + Cryptography
                </p>
            </article>
        </section>
        
    </div>
    
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª -->
    <nav class="bottom-nav">
        <button @click="switchSection('files')" 
                :class="{ 'active': currentSection === 'files' }">
            ğŸ“ Ø§Ù„Ù…Ù„ÙØ§Øª
        </button>
        <button @click="switchSection('tasks')" 
                :class="{ 'active': currentSection === 'tasks' }">
            âœ… Ø§Ù„Ù…Ù‡Ø§Ù…
        </button>
        <button @click="switchSection('logs')" 
                :class="{ 'active': currentSection === 'logs' }">
            ğŸ“œ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
        </button>
        <button @click="switchSection('settings')" 
                :class="{ 'active': currentSection === 'settings' }">
            âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        </button>
    </nav>
    
    <script>
        function app() {
            return {
                // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
                currentSection: 'files',
                
                // Ø§Ù„Ù…Ù„ÙØ§Øª
                files: [],
                uploading: false,
                fileStatus: { message: '', type: '' },
                
                // Ø§Ù„Ù…Ù‡Ø§Ù…
                tasks: [],
                newTask: { title: '', description: '', due_date: '' },
                taskStatus: { message: '', type: '' },
                
                // Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                logs: [],
                
                // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                backingUp: false,
                settingsStatus: { message: '', type: '' },
                
                // Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
                init() {
                    this.loadFiles();
                    this.loadTasks();
                    this.loadLogs();
                },
                
                // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
                switchSection(section) {
                    this.currentSection = section;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
                    if (section === 'files') this.loadFiles();
                    if (section === 'tasks') this.loadTasks();
                    if (section === 'logs') this.loadLogs();
                },
                
                // ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙØ§Øª =====
                async loadFiles() {
                    try {
                        const response = await fetch('/files');
                        this.files = await response.json();
                    } catch (error) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª:', error);
                    }
                },
                
                async uploadFile() {
                    const fileInput = this.$refs.fileInput;
                    if (!fileInput.files[0]) return;
                    
                    this.uploading = true;
                    this.fileStatus = { message: '', type: '' };
                    
                    const formData = new FormData();
                    formData.append('file', fileInput.files[0]);
                    
                    try {
                        const response = await fetch('/upload', {
                            method: 'POST',
                            body: formData
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.fileStatus = { 
                                message: 'âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù ÙˆØªØ´ÙÙŠØ±Ù‡ Ø¨Ù†Ø¬Ø§Ø­', 
                                type: 'success' 
                            };
                            fileInput.value = '';
                            await this.loadFiles();
                        } else {
                            this.fileStatus = { 
                                message: 'âŒ ' + data.error, 
                                type: 'error' 
                            };
                        }
                    } catch (error) {
                        this.fileStatus = { 
                            message: 'âŒ ÙØ´Ù„ ÙÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù', 
                            type: 'error' 
                        };
                    } finally {
                        this.uploading = false;
                        setTimeout(() => this.fileStatus = { message: '', type: '' }, 3000);
                    }
                },
                
                async downloadFile(filename) {
                    try {
                        window.location.href = `/download/${encodeURIComponent(filename)}`;
                    } catch (error) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:', error);
                    }
                },
                
                async deleteFile(filename) {
                    if (!confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù "${filename}"ØŸ`)) return;
                    
                    try {
                        const response = await fetch(`/files/${encodeURIComponent(filename)}`, {
                            method: 'DELETE'
                        });
                        
                        if (response.ok) {
                            this.fileStatus = { 
                                message: 'âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù', 
                                type: 'success' 
                            };
                            await this.loadFiles();
                        }
                    } catch (error) {
                        this.fileStatus = { 
                            message: 'âŒ ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù', 
                            type: 'error' 
                        };
                    } finally {
                        setTimeout(() => this.fileStatus = { message: '', type: '' }, 3000);
                    }
                },
                
                // ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù… =====
                async loadTasks() {
                    try {
                        const response = await fetch('/tasks');
                        this.tasks = await response.json();
                    } catch (error) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…:', error);
                    }
                },
                
                async addTask() {
                    if (!this.newTask.title.trim()) return;
                    
                    this.taskStatus = { message: '', type: '' };
                    
                    try {
                        const response = await fetch('/tasks', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(this.newTask)
                        });
                        
                        if (response.ok) {
                            this.taskStatus = { 
                                message: 'âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©', 
                                type: 'success' 
                            };
                            this.newTask = { title: '', description: '', due_date: '' };
                            await this.loadTasks();
                        }
                    } catch (error) {
                        this.taskStatus = { 
                            message: 'âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©', 
                            type: 'error' 
                        };
                    } finally {
                        setTimeout(() => this.taskStatus = { message: '', type: '' }, 3000);
                    }
                },
                
                async toggleTask(task) {
                    try {
                        const response = await fetch(`/tasks/${task.id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ completed: !task.completed })
                        });
                        
                        if (response.ok) {
                            await this.loadTasks();
                        }
                    } catch (error) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ù…Ø©:', error);
                    }
                },
                
                async deleteTask(taskId) {
                    if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')) return;
                    
                    try {
                        const response = await fetch(`/tasks/${taskId}`, {
                            method: 'DELETE'
                        });
                        
                        if (response.ok) {
                            this.taskStatus = { 
                                message: 'âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©', 
                                type: 'success' 
                            };
                            await this.loadTasks();
                        }
                    } catch (error) {
                        this.taskStatus = { 
                            message: 'âŒ ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©', 
                            type: 'error' 
                        };
                    } finally {
                        setTimeout(() => this.taskStatus = { message: '', type: '' }, 3000);
                    }
                },
                
                // ===== Ø§Ù„Ø³Ø¬Ù„Ø§Øª =====
                async loadLogs() {
                    try {
                        const response = await fetch('/logs');
                        const data = await response.json();
                        this.logs = data.logs || [];
                    } catch (error) {
                        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª:', error);
                    }
                },
                
                // ===== Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª =====
                async createBackup() {
                    this.backingUp = true;
                    this.settingsStatus = { message: '', type: '' };
                    
                    try {
                        const response = await fetch('/backup', {
                            method: 'POST'
                        });
                        
                        const data = await response.json();
                        
                        if (response.ok) {
                            this.settingsStatus = { 
                                message: `âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ${data.filename}`, 
                                type: 'success' 
                            };
                        } else {
                            this.settingsStatus = { 
                                message: 'âŒ ' + data.error, 
                                type: 'error' 
                            };
                        }
                    } catch (error) {
                        this.settingsStatus = { 
                            message: 'âŒ ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 
                            type: 'error' 
                        };
                    } finally {
                        this.backingUp = false;
                        setTimeout(() => this.settingsStatus = { message: '', type: '' }, 5000);
                    }
                },
                
                // ===== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© =====
                formatFileSize(bytes) {
                    if (bytes < 1024) return bytes + ' B';
                    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
                    return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
                },
                
                formatDate(dateString) {
                    if (!dateString) return '';
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ar-EG', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                }
            }
        }
    </script>
</body>
</html>
